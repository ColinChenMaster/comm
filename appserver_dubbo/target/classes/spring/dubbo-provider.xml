<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:aop="http://www.springframework.org/schema/aop"
	   xmlns:dubbo="http://code.alibabatech.com/schema/dubbo"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
	   http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd    
	   http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd
	   http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
	   ">
	   
	<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="locations">
            <list>
                <value>classpath:dubbo-config.properties</value>
            </list>
        </property>
    </bean>   
 	
 	<bean id="securityAspect" class="com.dubbo.aop.InputDataAspect"></bean>
 	<aop:config>  
        <aop:aspect id="aopAspect" ref="securityAspect">  
            <!--配置com.dubbo.service.impl包下所有类或接口的所有方法-->  
            <aop:pointcut id="securityPointcut" expression="execution(* com.dubbo.handle.register.*.*(..))" />  
            <aop:before pointcut-ref="securityPointcut" method="doBefore"/>  
            <aop:after pointcut-ref="securityPointcut" method="doAfter"/>  
            <aop:around pointcut-ref="securityPointcut" method="doAround"/> 
            <aop:after-returning pointcut-ref="securityPointcut" method="afterReturning"/> 
            <aop:after-throwing pointcut-ref="securityPointcut" method="doThrowing" throwing="ex"/>  
        </aop:aspect>  
    </aop:config> 
 	
 	<!-- 应用信息 -->
	<dubbo:application name="vipkid-appserver"/>
	
	<!-- 注册中心 -->
	<!-- <dubbo:registry id="zookeeper" address="zookeeper://192.168.80.129:2181" />-->
	<dubbo:registry address="multicast://224.5.6.7:1234" /> 

	<!-- 协议 -->
	<dubbo:protocol name="dubbo" port="20880" dispatcher="all" threadpool="cached" threads="100" serialization="hessian2" />   	
   	 
   	<!-- 暴露注册模块相关服务 -->
   	<dubbo:service protocol="dubbo" interface="com.dubbo.handle.register.ChannelService"    ref="channelServiceImpl"     cluster="${dubbo.config.cluster}" loadbalance="${dubbo.config.loadbalance}" version="${dubbo.config.version}" timeout="${dubbo.config.timeout}" delay="${dubbo.config.delay}" token="${dubbo.config.token}"/>	
   	<dubbo:service protocol="dubbo" interface="com.dubbo.handle.register.ParentAuthService" ref="parentAuthServiceImpl"  cluster="${dubbo.config.cluster}" loadbalance="${dubbo.config.loadbalance}" version="${dubbo.config.version}" timeout="${dubbo.config.timeout}" delay="${dubbo.config.delay}" token="${dubbo.config.token}"/>   	
   	<dubbo:service protocol="dubbo" interface="com.dubbo.handle.register.StudentService"    ref="studentServiceImpl"     cluster="${dubbo.config.cluster}" loadbalance="${dubbo.config.loadbalance}" version="${dubbo.config.version}" timeout="${dubbo.config.timeout}" delay="${dubbo.config.delay}" token="${dubbo.config.token}"/>
   	<dubbo:service protocol="dubbo" interface="com.dubbo.handle.register.RegisterService"   ref="registerServiceImpl"    cluster="${dubbo.config.cluster}" loadbalance="${dubbo.config.loadbalance}" version="${dubbo.config.version}" timeout="${dubbo.config.timeout}" delay="${dubbo.config.delay}" token="${dubbo.config.token}"/>
   	
</beans>
